---
title: Examples
description: Real-world examples and use cases for x402 SDK
---

Real-world examples and use cases to help you implement x402 SDK in your applications.

## Basic Examples

### Simple Premium API

A basic Express.js API with free and premium endpoints.

```typescript
import express from 'express';
import { createX402Middleware } from 'x402-framework-sdk/express';

const app = express();
app.use(express.json());

const x402 = createX402Middleware({
  facilitatorUrl: process.env.X402_FACILITATOR_URL,
  merchantAddress: process.env.X402_MERCHANT_ADDRESS
});

// Free endpoint
app.get('/api/public', (req, res) => {
  res.json({
    message: 'Public data available to everyone',
    data: {
      basicInfo: 'This is free content',
      timestamp: new Date().toISOString()
    }
  });
});

// Premium endpoint - 0.01 SOL
app.get('/api/premium', 
  x402.requirePayment(0.01),
  (req, res) => {
    res.json({
      message: 'Premium data unlocked!',
      data: {
        exclusiveContent: 'Advanced analytics and insights',
        premiumFeatures: [
          'Real-time data',
          'Advanced filtering',
          'Export capabilities',
          'Priority support'
        ],
        userInfo: {
          paidAmount: req.x402.amount,
          paymentSignature: req.x402.signature,
          accessLevel: 'premium'
        }
      }
    });
  }
);

app.listen(3000, () => {
  console.log('Premium API server running on port 3000');
});
```

### Client Usage

```typescript
import { X402Client, X402Wallet } from 'x402-client';

async function accessPremiumContent() {
  // Create wallet
  const wallet = X402Wallet.create();
  console.log('Wallet created:', wallet.getPublicKey());
  
  // Create client
  const client = new X402Client({
    wallet,
    facilitatorUrl: 'http://localhost:3001'
  });
  
  try {
    // Access premium endpoint
    const response = await client.payAndFetch('http://localhost:3000/api/premium', {
      amount: 0.01
    });
    
    console.log('Premium content accessed:', response);
  } catch (error) {
    console.error('Payment failed:', error.message);
  }
}

accessPremiumContent();
```

## Advanced Examples

### Multi-Tier Pricing API

API with multiple pricing tiers and features.

```typescript
import express from 'express';
import { createX402Middleware } from 'x402-framework-sdk/express';

const app = express();
app.use(express.json());

const x402 = createX402Middleware({
  facilitatorUrl: process.env.X402_FACILITATOR_URL,
  merchantAddress: process.env.X402_MERCHANT_ADDRESS,
  nonceStorage: 'redis', // Use Redis for production
  debug: process.env.NODE_ENV === 'development'
});

// Free tier - Rate limited
app.get('/api/data/basic', (req, res) => {
  res.json({
    tier: 'free',
    data: 'Basic data with 15-minute delay',
    limits: {
      requestsPerHour: 100,
      dataRetention: '24 hours',
      support: 'Community forum'
    }
  });
});

// Starter tier - 0.005 SOL
app.get('/api/data/starter',
  x402.requirePayment(0.005),
  (req, res) => {
    res.json({
      tier: 'starter',
      data: 'Real-time data with basic features',
      features: [
        'Real-time updates',
        'Basic analytics',
        'Email support'
      ],
      limits: {
        requestsPerHour: 1000,
        dataRetention: '7 days',
        support: 'Email support'
      }
    });
  }
);

// Pro tier - 0.02 SOL
app.get('/api/data/pro',
  x402.requirePayment(0.02),
  (req, res) => {
    res.json({
      tier: 'pro',
      data: 'Advanced analytics and insights',
      features: [
        'Real-time data',
        'Advanced analytics',
        'Custom dashboards',
        'API access',
        'Priority support'
      ],
      limits: {
        requestsPerHour: 10000,
        dataRetention: '30 days',
        support: '24/7 chat support'
      }
    });
  }
);

// Enterprise tier - 0.1 SOL
app.get('/api/data/enterprise',
  x402.requirePayment(0.1),
  (req, res) => {
    res.json({
      tier: 'enterprise',
      data: 'Full enterprise features',
      features: [
        'Unlimited requests',
        'Custom integrations',
        'Dedicated support',
        'SLA guarantees',
        'White-label options'
      ],
      limits: {
        requestsPerHour: 'unlimited',
        dataRetention: '1 year',
        support: 'Dedicated account manager'
      }
    });
  }
);

app.listen(3000);
```

### AI Service with Pay-per-Use

AI text generation service with payment per request.

```typescript
import express from 'express';
import { createX402Middleware } from 'x402-framework-sdk/express';

const app = express();
app.use(express.json());

const x402 = createX402Middleware({
  facilitatorUrl: process.env.X402_FACILITATOR_URL,
  merchantAddress: process.env.X402_MERCHANT_ADDRESS
});

// AI text generation - 0.01 SOL per request
app.post('/api/ai/generate',
  x402.requirePayment(0.01),
  async (req, res) => {
    const { prompt, maxTokens = 100, temperature = 0.7 } = req.body;
    
    if (!prompt) {
      return res.status(400).json({
        error: 'Prompt is required'
      });
    }
    
    try {
      // Simulate AI processing
      const generatedText = await generateAIText(prompt, {
        maxTokens,
        temperature
      });
      
      res.json({
        success: true,
        data: {
          prompt,
          generatedText,
          metadata: {
            tokensUsed: generatedText.split(' ').length,
            model: 'gpt-4-turbo',
            processingTime: '2.3s',
            cost: req.x402.amount
          }
        },
        payment: {
          amount: req.x402.amount,
          signature: req.x402.signature,
          timestamp: req.x402.timestamp
        }
      });
    } catch (error) {
      res.status(500).json({
        error: 'AI generation failed',
        message: error.message
      });
    }
  }
);

// AI image generation - 0.05 SOL per image
app.post('/api/ai/image',
  x402.requirePayment(0.05),
  async (req, res) => {
    const { prompt, size = '512x512', style = 'realistic' } = req.body;
    
    try {
      const imageUrl = await generateAIImage(prompt, { size, style });
      
      res.json({
        success: true,
        data: {
          prompt,
          imageUrl,
          metadata: {
            size,
            style,
            processingTime: '15.2s',
            cost: req.x402.amount
          }
        }
      });
    } catch (error) {
      res.status(500).json({
        error: 'Image generation failed',
        message: error.message
      });
    }
  }
);

// Simulate AI functions
async function generateAIText(prompt, options) {
  // Simulate processing delay
  await new Promise(resolve => setTimeout(resolve, 2000));
  
  return `Generated response for: "${prompt}". This is a simulated AI response with ${options.maxTokens} max tokens and ${options.temperature} temperature.`;
}

async function generateAIImage(prompt, options) {
  // Simulate processing delay
  await new Promise(resolve => setTimeout(resolve, 15000));
  
  return `https://example.com/generated-image-${Date.now()}.png`;
}

app.listen(3000);
```

### File Download Service

Premium file download service with different access levels.

```typescript
import express from 'express';
import path from 'path';
import { createX402Middleware } from 'x402-framework-sdk/express';

const app = express();
const x402 = createX402Middleware({
  facilitatorUrl: process.env.X402_FACILITATOR_URL,
  merchantAddress: process.env.X402_MERCHANT_ADDRESS
});

// Free downloads - Low quality
app.get('/api/download/free/:fileId', (req, res) => {
  const { fileId } = req.params;
  
  res.json({
    downloadUrl: `https://cdn.example.com/free/${fileId}_low.pdf`,
    quality: 'low',
    watermark: true,
    expires: new Date(Date.now() + 3600000).toISOString() // 1 hour
  });
});

// Premium downloads - High quality - 0.001 SOL
app.get('/api/download/premium/:fileId',
  x402.requirePayment(0.001),
  (req, res) => {
    const { fileId } = req.params;
    
    res.json({
      downloadUrl: `https://cdn.example.com/premium/${fileId}_high.pdf`,
      quality: 'high',
      watermark: false,
      expires: new Date(Date.now() + 86400000).toISOString(), // 24 hours
      payment: {
        amount: req.x402.amount,
        signature: req.x402.signature
      }
    });
  }
);

// Bulk download - 0.01 SOL
app.post('/api/download/bulk',
  x402.requirePayment(0.01),
  (req, res) => {
    const { fileIds } = req.body;
    
    if (!Array.isArray(fileIds) || fileIds.length === 0) {
      return res.status(400).json({
        error: 'fileIds array is required'
      });
    }
    
    const downloadUrls = fileIds.map(fileId => ({
      fileId,
      url: `https://cdn.example.com/premium/${fileId}_high.pdf`,
      quality: 'high'
    }));
    
    res.json({
      bulkDownload: true,
      files: downloadUrls,
      zipUrl: `https://cdn.example.com/bulk/${Date.now()}.zip`,
      expires: new Date(Date.now() + 86400000).toISOString(),
      totalFiles: fileIds.length,
      payment: {
        amount: req.x402.amount,
        costPerFile: req.x402.amount / fileIds.length
      }
    });
  }
);

app.listen(3000);
```

## Next.js Examples

### API Routes with App Router

```typescript
// app/api/premium/route.ts
import { withX402 } from 'x402-framework-sdk/nextjs';

export const GET = withX402(
  async (request) => {
    const url = new URL(request.url);
    const category = url.searchParams.get('category') || 'general';
    
    return Response.json({
      message: 'Premium content accessed',
      category,
      data: {
        exclusiveContent: `Premium ${category} content`,
        features: ['Advanced analytics', 'Real-time data', 'Export options']
      },
      timestamp: new Date().toISOString()
    });
  },
  {
    amount: 0.01,
    merchantAddress: process.env.X402_MERCHANT_ADDRESS!,
    facilitatorUrl: process.env.X402_FACILITATOR_URL!
  }
);

export const POST = withX402(
  async (request) => {
    const body = await request.json();
    
    // Process premium request
    const result = await processPremiumRequest(body);
    
    return Response.json({
      success: true,
      result,
      requestData: body
    });
  },
  {
    amount: 0.02,
    merchantAddress: process.env.X402_MERCHANT_ADDRESS!,
    facilitatorUrl: process.env.X402_FACILITATOR_URL!
  }
);

async function processPremiumRequest(data: any) {
  // Simulate premium processing
  return {
    processed: true,
    timestamp: new Date().toISOString(),
    data: `Processed: ${JSON.stringify(data)}`
  };
}
```

### React Component with Payment

```typescript
// components/PremiumContent.tsx
'use client';

import { useState } from 'react';
import { X402Client, X402Wallet } from 'x402-client';

export default function PremiumContent() {
  const [content, setContent] = useState<any>(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const accessPremiumContent = async () => {
    setLoading(true);
    setError(null);
    
    try {
      // Create wallet (in real app, you'd manage this properly)
      const wallet = X402Wallet.create();
      
      const client = new X402Client({
        wallet,
        facilitatorUrl: process.env.NEXT_PUBLIC_FACILITATOR_URL!
      });
      
      const response = await client.payAndFetch('/api/premium', {
        amount: 0.01,
        method: 'GET'
      });
      
      setContent(response);
    } catch (err: any) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="p-6 max-w-md mx-auto bg-white rounded-xl shadow-md">
      <h2 className="text-xl font-bold mb-4">Premium Content</h2>
      
      {!content && (
        <div>
          <p className="mb-4">Access premium content for 0.01 SOL</p>
          <button
            onClick={accessPremiumContent}
            disabled={loading}
            className="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 disabled:opacity-50"
          >
            {loading ? 'Processing Payment...' : 'Pay & Access (0.01 SOL)'}
          </button>
        </div>
      )}
      
      {error && (
        <div className="mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded">
          Error: {error}
        </div>
      )}
      
      {content && (
        <div className="mt-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded">
          <h3 className="font-bold">Premium Content Unlocked!</h3>
          <pre className="mt-2 text-sm overflow-auto">
            {JSON.stringify(content, null, 2)}
          </pre>
        </div>
      )}
    </div>
  );
}
```

## Real-World Use Cases

### 1. API Rate Limiting

```typescript
// Free tier: 100 requests/hour
// Paid tier: Unlimited requests
app.get('/api/data',
  x402.optionalPayment(0.005),
  rateLimitMiddleware,
  (req, res) => {
    const isPaid = req.x402?.verified;
    
    if (!isPaid) {
      // Apply rate limiting for free users
      const remaining = getRemainingRequests(req.ip);
      if (remaining <= 0) {
        return res.status(429).json({
          error: 'Rate limit exceeded',
          message: 'Upgrade to paid tier for unlimited access',
          upgradeUrl: '/upgrade'
        });
      }
    }
    
    // Serve data
    res.json({
      data: 'Your requested data',
      tier: isPaid ? 'paid' : 'free',
      remaining: isPaid ? 'unlimited' : getRemainingRequests(req.ip)
    });
  }
);
```

### 2. Content Paywall

```typescript
// Blog with premium articles
app.get('/api/article/:id',
  x402.optionalPayment(0.002),
  async (req, res) => {
    const { id } = req.params;
    const isPaid = req.x402?.verified;
    
    const article = await getArticle(id);
    
    if (article.isPremium && !isPaid) {
      return res.json({
        title: article.title,
        excerpt: article.excerpt,
        isPremium: true,
        paymentRequired: 0.002,
        message: 'Pay 0.002 SOL to read the full article'
      });
    }
    
    res.json({
      ...article,
      fullAccess: true,
      paid: isPaid
    });
  }
);
```

### 3. SaaS API with Usage Tracking

```typescript
app.post('/api/process',
  x402.requirePayment(0.001), // Pay per API call
  async (req, res) => {
    const startTime = Date.now();
    
    try {
      const result = await processData(req.body);
      const processingTime = Date.now() - startTime;
      
      // Track usage
      await trackUsage({
        userId: req.x402.publicKey,
        endpoint: '/api/process',
        cost: req.x402.amount,
        processingTime,
        timestamp: new Date()
      });
      
      res.json({
        success: true,
        result,
        billing: {
          cost: req.x402.amount,
          processingTime: `${processingTime}ms`,
          signature: req.x402.signature
        }
      });
    } catch (error) {
      res.status(500).json({
        error: 'Processing failed',
        refund: 'Automatic refund initiated'
      });
    }
  }
);
```

## Testing Examples

### Unit Tests

```typescript
import request from 'supertest';
import { X402Wallet } from 'x402-client';
import app from '../app';

describe('Premium API', () => {
  let wallet: X402Wallet;
  
  beforeEach(() => {
    wallet = X402Wallet.create();
  });
  
  test('should require payment for premium endpoint', async () => {
    const response = await request(app)
      .get('/api/premium')
      .expect(402);
    
    expect(response.body).toMatchObject({
      error: 'Payment Required',
      amount: 0.01
    });
  });
  
  test('should accept valid payment', async () => {
    const paymentData = createPaymentData(wallet, 0.01);
    
    const response = await request(app)
      .get('/api/premium')
      .set('x-payment', JSON.stringify(paymentData))
      .expect(200);
    
    expect(response.body.message).toBe('Premium content unlocked!');
  });
});

function createPaymentData(wallet: X402Wallet, amount: number) {
  const timestamp = Date.now();
  const nonce = Math.random().toString(36).substring(2);
  const message = `${amount}:${timestamp}:${nonce}`;
  const signature = wallet.sign(new TextEncoder().encode(message));
  
  return {
    amount,
    signature: bs58.encode(signature),
    publicKey: wallet.getPublicKey(),
    timestamp,
    nonce
  };
}
```

### Integration Tests

```typescript
import { X402Client, X402Wallet } from 'x402-client';

describe('Full Payment Flow', () => {
  let client: X402Client;
  
  beforeEach(() => {
    const wallet = X402Wallet.create();
    client = new X402Client({
      wallet,
      facilitatorUrl: 'http://localhost:3001'
    });
  });
  
  test('should complete full payment flow', async () => {
    const response = await client.payAndFetch('http://localhost:3000/api/premium', {
      amount: 0.01
    });
    
    expect(response.success).toBe(true);
    expect(response.data).toBeDefined();
    expect(response.payment.amount).toBe(0.01);
  });
});
```

---

**Next**: [Security â†’](/docs/security)
